<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>PDF+</title>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- 1. PDF-LIB (Core PDF Logic) -->
    <script src="https://unpkg.com/pdf-lib@1.17.1/dist/pdf-lib.min.js"></script>
    
    <!-- 2. FileSaver (Downloads) -->
    <script src="https://unpkg.com/downloadjs@1.4.7/download.min.js"></script>
    
    <!-- 3. JSZip (Utilities) -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>
    
    <!-- 4. PDF.js (Reading Text for Notebook) -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.min.js"></script>
    
    <!-- Icons -->
    <script src="https://unpkg.com/lucide@latest"></script>
    
    <!-- Handwriting Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Patrick+Hand&family=Caveat:wght@400;700&display=swap" rel="stylesheet">
    
    <!-- Page Flip Library -->
    <script src="https://cdn.jsdelivr.net/npm/page-flip@2.0.7/dist/js/page-flip.browser.js"></script>

    <link rel="stylesheet" href="css/style.css">
</head>
<body class="h-screen w-full overflow-hidden flex flex-col relative bg-slate-50">

    <!-- App Header -->
    <header class="bg-white/95 backdrop-blur-sm shadow-sm z-20 flex-none h-16 flex items-center justify-between px-5 border-b border-gray-100 sticky top-0">
        <div class="flex items-center gap-3" onclick="showHome()">
            <!-- Native App Icon Style -->
            <div class="w-9 h-9 bg-red-500 rounded-xl flex items-center justify-center text-white font-bold shadow-md shadow-red-200">
                <i data-lucide="file-text" class="w-5 h-5 text-white"></i>
            </div>
            <h1 class="text-xl font-bold text-gray-800 tracking-tight">PDF+</h1>
        </div>
        <button id="headerBackBtn" class="hidden p-2 rounded-full hover:bg-gray-100 btn-press text-gray-600 transition-colors" onclick="showHome()">
            <i data-lucide="x" class="w-6 h-6"></i>
        </button>
    </header>

    <!-- Main Content Area -->
    <main class="flex-1 overflow-y-auto no-scrollbar relative w-full max-w-lg mx-auto bg-white sm:shadow-2xl sm:my-6 sm:rounded-2xl sm:h-[calc(100vh-3rem)] sm:border border-gray-100">
        
        <!-- DASHBOARD (Home) -->
        <div id="screen-home" class="screen active flex-col p-6 min-h-full bg-white">
            <div class="mb-6">
                <h2 class="text-2xl font-bold text-gray-900">Tools</h2>
                <p class="text-gray-400 text-sm mt-1">Select an action to process your files.</p>
            </div>

            <!-- Tools Grid -->
            <div class="grid grid-cols-2 gap-4 pb-12" id="tools-grid">
                <!-- 1. Notebook (Featured) -->
                <div onclick="openTool('notebook')" class="col-span-2 bg-yellow-50 p-5 rounded-2xl flex items-center justify-between gap-4 cursor-pointer btn-press border border-yellow-100 hover:border-yellow-200 shadow-sm relative overflow-hidden group">
                    <div class="flex flex-col gap-1 z-10">
                        <span class="font-bold text-yellow-900 text-lg">PDF to Notebook</span>
                        <span class="text-yellow-700 text-xs">Convert text to handwriting ‚úçÔ∏è</span>
                    </div>
                    <div class="w-12 h-12 bg-white rounded-full flex items-center justify-center text-yellow-500 shadow-sm z-10">
                        <i data-lucide="pen-tool" class="w-6 h-6"></i>
                    </div>
                    <!-- Decorative BG -->
                    <div class="absolute -right-4 -bottom-4 w-24 h-24 bg-yellow-100 rounded-full opacity-50 group-hover:scale-150 transition-transform duration-500"></div>
                </div>

                <!-- 2. Merge -->
                <div onclick="openTool('merge')" class="bg-red-50 p-4 rounded-2xl flex flex-col items-center justify-center gap-3 cursor-pointer btn-press border border-red-100 hover:border-red-200 h-32">
                    <div class="w-10 h-10 bg-white rounded-full flex items-center justify-center shadow-sm text-red-500">
                        <i data-lucide="files" class="w-5 h-5"></i>
                    </div>
                    <span class="font-semibold text-gray-700 text-xs">Merge</span>
                </div>

                <!-- 3. Split -->
                <div onclick="openTool('split')" class="bg-blue-50 p-4 rounded-2xl flex flex-col items-center justify-center gap-3 cursor-pointer btn-press border border-blue-100 hover:border-blue-200 h-32">
                    <div class="w-10 h-10 bg-white rounded-full flex items-center justify-center shadow-sm text-blue-500">
                        <i data-lucide="scissors" class="w-5 h-5"></i>
                    </div>
                    <span class="font-semibold text-gray-700 text-xs">Split</span>
                </div>

                <!-- 4. PDF to Image -->
                <div onclick="openTool('pdf2img')" class="bg-orange-50 p-4 rounded-2xl flex flex-col items-center justify-center gap-3 cursor-pointer btn-press border border-orange-100 hover:border-orange-200 h-32">
                    <div class="w-10 h-10 bg-white rounded-full flex items-center justify-center shadow-sm text-orange-500">
                        <i data-lucide="image-down" class="w-5 h-5"></i>
                    </div>
                    <span class="font-semibold text-gray-700 text-xs">PDF to IMG</span>
                </div>

                <!-- 5. Image to PDF -->
                <div onclick="openTool('img2pdf')" class="bg-green-50 p-4 rounded-2xl flex flex-col items-center justify-center gap-3 cursor-pointer btn-press border border-green-100 hover:border-green-200 h-32">
                    <div class="w-10 h-10 bg-white rounded-full flex items-center justify-center shadow-sm text-green-500">
                        <i data-lucide="image-plus" class="w-5 h-5"></i>
                    </div>
                    <span class="font-semibold text-gray-700 text-xs">IMG to PDF</span>
                </div>

                <!-- 6. Protect -->
                <div onclick="openTool('protect')" class="bg-gray-100 p-4 rounded-2xl flex flex-col items-center justify-center gap-3 cursor-pointer btn-press border border-gray-200 hover:border-gray-300 h-32">
                    <div class="w-10 h-10 bg-white rounded-full flex items-center justify-center shadow-sm text-gray-600">
                        <i data-lucide="lock" class="w-5 h-5"></i>
                    </div>
                    <span class="font-semibold text-gray-700 text-xs">Protect</span>
                </div>

                <!-- 7. Collage/Grid -->
                <div onclick="openTool('grid')" class="bg-indigo-50 p-4 rounded-2xl flex flex-col items-center justify-center gap-3 cursor-pointer btn-press border border-indigo-100 hover:border-indigo-200 h-32">
                    <div class="w-10 h-10 bg-white rounded-full flex items-center justify-center shadow-sm text-indigo-500">
                        <i data-lucide="layout-grid" class="w-5 h-5"></i>
                    </div>
                    <span class="font-semibold text-gray-700 text-xs">Collage</span>
                </div>

                <!-- 8. PDF Viewer -->
                <div onclick="openTool('viewer')" class="bg-teal-50 p-4 rounded-2xl flex flex-col items-center justify-center gap-3 cursor-pointer btn-press border border-teal-100 hover:border-teal-200 h-32">
                    <div class="w-10 h-10 bg-white rounded-full flex items-center justify-center shadow-sm text-teal-500">
                        <i data-lucide="eye" class="w-5 h-5"></i>
                    </div>
                    <span class="font-semibold text-gray-700 text-xs">Viewer</span>
                </div>

                <!-- 9. Organize -->
                <div onclick="openTool('organize')" class="bg-purple-50 p-4 rounded-2xl flex flex-col items-center justify-center gap-3 cursor-pointer btn-press border border-purple-100 hover:border-purple-200 h-32">
                    <div class="w-10 h-10 bg-white rounded-full flex items-center justify-center shadow-sm text-purple-500">
                        <i data-lucide="layout-list" class="w-5 h-5"></i>
                    </div>
                    <span class="font-semibold text-gray-700 text-xs">Organize</span>
                </div>

                <!-- 10. Watermark -->
                <div onclick="openTool('watermark')" class="bg-cyan-50 p-4 rounded-2xl flex flex-col items-center justify-center gap-3 cursor-pointer btn-press border border-cyan-100 hover:border-cyan-200 h-32">
                    <div class="w-10 h-10 bg-white rounded-full flex items-center justify-center shadow-sm text-cyan-500">
                        <i data-lucide="stamp" class="w-5 h-5"></i>
                    </div>
                    <span class="font-semibold text-gray-700 text-xs">Watermark</span>
                </div>

                <!-- 11. Page Numbers -->
                <div onclick="openTool('pagenumber')" class="bg-pink-50 p-4 rounded-2xl flex flex-col items-center justify-center gap-3 cursor-pointer btn-press border border-pink-100 hover:border-pink-200 h-32">
                    <div class="w-10 h-10 bg-white rounded-full flex items-center justify-center shadow-sm text-pink-500">
                        <i data-lucide="hash" class="w-5 h-5"></i>
                    </div>
                    <span class="font-semibold text-gray-700 text-xs">Page Numbers</span>
                </div>

                <!-- 12. Doc Scanner -->
                <div onclick="openTool('scanner')" class="col-span-2 bg-slate-800 p-5 rounded-2xl flex items-center justify-between gap-4 cursor-pointer btn-press border border-slate-700 hover:border-slate-600 shadow-sm relative overflow-hidden group">
                    <div class="flex flex-col gap-1 z-10">
                        <span class="font-bold text-white text-lg">Doc Scanner</span>
                        <span class="text-slate-400 text-xs">Camera to PDF + Filters üì∏</span>
                    </div>
                    <div class="w-12 h-12 bg-slate-700 rounded-full flex items-center justify-center text-white shadow-sm z-10">
                        <i data-lucide="scan" class="w-6 h-6"></i>
                    </div>
                    <div class="absolute -right-4 -bottom-4 w-24 h-24 bg-slate-700 rounded-full opacity-50 group-hover:scale-150 transition-transform duration-500"></div>
                </div>

                <!-- 13. Sign PDF -->
                <div onclick="openTool('sign')" class="bg-blue-50 p-4 rounded-2xl flex flex-col items-center justify-center gap-3 cursor-pointer btn-press border border-blue-100 hover:border-blue-200 h-32">
                    <div class="w-10 h-10 bg-white rounded-full flex items-center justify-center shadow-sm text-blue-500">
                        <i data-lucide="pen-tool" class="w-5 h-5"></i>
                    </div>
                    <span class="font-semibold text-gray-700 text-xs">Sign PDF</span>
                </div>

                <!-- 14. Text to PDF -->
                <div onclick="openTool('text2pdf')" class="bg-emerald-50 p-4 rounded-2xl flex flex-col items-center justify-center gap-3 cursor-pointer btn-press border border-emerald-100 hover:border-emerald-200 h-32">
                    <div class="w-10 h-10 bg-white rounded-full flex items-center justify-center shadow-sm text-emerald-500">
                        <i data-lucide="type" class="w-5 h-5"></i>
                    </div>
                    <span class="font-semibold text-gray-700 text-xs">Text to PDF</span>
                </div>

                <!-- 15. Compress -->
                <div onclick="openTool('compress')" class="bg-rose-50 p-4 rounded-2xl flex flex-col items-center justify-center gap-3 cursor-pointer btn-press border border-rose-100 hover:border-rose-200 h-32">
                    <div class="w-10 h-10 bg-white rounded-full flex items-center justify-center shadow-sm text-rose-500">
                        <i data-lucide="minimize-2" class="w-5 h-5"></i>
                    </div>
                    <span class="font-semibold text-gray-700 text-xs">Compress</span>
                </div>

                <!-- 16. Tint/Color -->
                <div onclick="openTool('tint')" class="bg-amber-50 p-4 rounded-2xl flex flex-col items-center justify-center gap-3 cursor-pointer btn-press border border-amber-100 hover:border-amber-200 h-32">
                    <div class="w-10 h-10 bg-white rounded-full flex items-center justify-center shadow-sm text-amber-500">
                        <i data-lucide="palette" class="w-5 h-5"></i>
                    </div>
                    <span class="font-semibold text-gray-700 text-xs">Page Color</span>
                </div>
            </div>
        </div>

        <!-- 1. NOTEBOOK TOOL (Main Feature) -->
        <div id="tool-notebook" class="screen flex-col h-full hidden bg-white">
            <div class="p-6 flex-1 flex flex-col gap-6">
                <div class="text-center">
                    <h3 class="text-xl font-bold text-gray-800">PDF to Notebook</h3>
                    <p class="text-xs text-gray-500">Extracts text & converts to handwriting.</p>
                </div>

                <div class="bg-yellow-50/50 border-2 border-dashed border-yellow-200 rounded-xl p-6 flex flex-col items-center justify-center relative hover:bg-yellow-50 transition h-32">
                    <input type="file" id="notebookInput" accept=".pdf" class="absolute inset-0 opacity-0 cursor-pointer z-10" onchange="handleFileSelect('notebook')">
                    <i data-lucide="pen-line" class="w-8 h-8 text-yellow-600 mb-2"></i>
                    <p id="notebookFileName" class="text-sm font-medium text-gray-600 truncate max-w-[200px]">Select PDF</p>
                </div>

                <!-- Notebook Style Options -->
                <div id="notebookOptions" class="hidden flex-col gap-4">
                    <p class="text-xs font-bold text-gray-400 uppercase tracking-wide">Ink Style</p>
                    <div class="grid grid-cols-3 gap-2">
                        <button onclick="setInk('blue', this)" class="ink-opt active ring-2 ring-blue-500 p-2 bg-white border rounded-lg text-xs font-medium text-blue-600 flex items-center justify-center gap-1">
                            <div class="w-3 h-3 rounded-full bg-blue-600"></div> Blue
                        </button>
                        <button onclick="setInk('black', this)" class="ink-opt p-2 bg-white border rounded-lg text-xs font-medium text-gray-800 flex items-center justify-center gap-1">
                            <div class="w-3 h-3 rounded-full bg-gray-800"></div> Black
                        </button>
                        <button onclick="setInk('mixed', this)" class="ink-opt p-2 bg-white border rounded-lg text-xs font-medium text-purple-600 flex items-center justify-center gap-1">
                            <div class="w-3 h-3 rounded-full bg-gradient-to-r from-blue-500 to-red-500"></div> Mix
                        </button>
                    </div>
                </div>

                <div class="flex-1"></div>
                <button id="btn-notebook-action" onclick="processNotebook()" disabled class="w-full bg-yellow-500 text-white font-semibold py-4 rounded-xl shadow-lg shadow-yellow-200 btn-press disabled:opacity-50 disabled:cursor-not-allowed">
                    Convert to Notebook
                </button>
            </div>
        </div>

        <!-- 2. PROTECT TOOL (Fixed) -->
        <div id="tool-protect" class="screen flex-col h-full hidden bg-white">
            <div class="p-6 flex-1 flex flex-col gap-6">
                <div class="text-center">
                    <h3 class="text-xl font-bold text-gray-800">Protect PDF</h3>
                    <p class="text-xs text-gray-500">Secure with password.</p>
                </div>
                <div class="bg-gray-50 border-2 border-dashed border-gray-200 rounded-xl p-6 flex flex-col items-center justify-center relative h-32">
                    <input type="file" id="protectInput" accept=".pdf" class="absolute inset-0 opacity-0 cursor-pointer z-10" onchange="handleFileSelect('protect')">
                    <i data-lucide="shield-check" class="w-8 h-8 text-gray-400 mb-2"></i>
                    <p id="protectFileName" class="text-sm font-medium text-gray-600 truncate max-w-[200px]">Select PDF</p>
                </div>
                
                <div id="protectOptions" class="hidden flex-col gap-2">
                    <label class="text-xs font-bold text-gray-400 uppercase tracking-wide">Set Password</label>
                    <div class="relative">
                        <input type="password" id="pdfPassword" placeholder="Enter secure password" class="w-full bg-gray-50 border border-gray-200 rounded-lg p-3 text-sm focus:outline-none focus:ring-2 focus:ring-gray-500 transition-all">
                        <i data-lucide="key" class="w-4 h-4 text-gray-400 absolute right-3 top-3.5"></i>
                    </div>
                </div>

                <div class="flex-1"></div>
                <button id="btn-protect-action" onclick="processProtect()" disabled class="w-full bg-gray-800 text-white font-semibold py-4 rounded-xl shadow-lg shadow-gray-200 btn-press disabled:opacity-50">
                    Lock PDF
                </button>
            </div>
        </div>

        <!-- 3. MERGE TOOL -->
        <div id="tool-merge" class="screen flex-col h-full hidden bg-white">
            <div class="p-6 flex-1 flex flex-col gap-6">
                <div class="text-center">
                    <h3 class="text-xl font-bold text-gray-800">Merge PDF</h3>
                    <p class="text-xs text-gray-500">Combine multiple files.</p>
                </div>
                <div class="bg-red-50/50 border-2 border-dashed border-red-200 rounded-xl p-6 flex flex-col items-center justify-center relative hover:bg-red-50 transition h-32">
                    <input type="file" id="mergeInput" multiple accept=".pdf" class="absolute inset-0 opacity-0 cursor-pointer z-10" onchange="handleFileSelect('merge')">
                    <i data-lucide="layers" class="w-8 h-8 text-red-400 mb-2"></i>
                    <p class="text-sm font-medium text-gray-600">Tap to select files</p>
                </div>
                <div id="mergeFileList" class="flex flex-col gap-2 overflow-y-auto max-h-48 hidden"></div>
                <div class="flex-1"></div>
                <button id="btn-merge-action" onclick="processMerge()" disabled class="w-full bg-red-500 text-white font-semibold py-4 rounded-xl shadow-lg shadow-red-200 btn-press disabled:opacity-50">Merge Files</button>
            </div>
        </div>

        <!-- 4. SPLIT TOOL -->
        <div id="tool-split" class="screen flex-col h-full hidden bg-white">
            <div class="p-6 flex-1 flex flex-col gap-6">
                <div class="text-center">
                    <h3 class="text-xl font-bold text-gray-800">Split PDF</h3>
                    <p class="text-xs text-gray-500">Extract pages.</p>
                </div>
                <div class="bg-blue-50/50 border-2 border-dashed border-blue-200 rounded-xl p-6 flex flex-col items-center justify-center relative h-32">
                    <input type="file" id="splitInput" accept=".pdf" class="absolute inset-0 opacity-0 cursor-pointer z-10" onchange="handleFileSelect('split')">
                    <p id="splitFileName" class="text-sm font-medium text-blue-600 truncate max-w-[200px]">Select PDF</p>
                </div>
                <div id="splitOptions" class="hidden flex-col gap-2">
                    <label class="text-xs font-bold text-gray-400 uppercase tracking-wide">Page Numbers</label>
                    <input type="text" id="splitPages" placeholder="e.g. 1, 3, 5-8" class="w-full bg-gray-50 border border-gray-200 rounded-lg p-3 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500">
                </div>
                <div class="flex-1"></div>
                <button id="btn-split-action" onclick="processSplit()" disabled class="w-full bg-blue-500 text-white font-semibold py-4 rounded-xl shadow-lg shadow-blue-200 btn-press disabled:opacity-50">Split PDF</button>
            </div>
        </div>

        <!-- 5. IMG TO PDF -->
        <div id="tool-img2pdf" class="screen flex-col h-full hidden bg-white">
            <div class="p-6 flex-1 flex flex-col gap-6">
                <div class="text-center">
                    <h3 class="text-xl font-bold text-gray-800">Images to PDF</h3>
                    <p class="text-xs text-gray-500">Photos to Document.</p>
                </div>
                <div class="bg-green-50/50 border-2 border-dashed border-green-200 rounded-xl p-6 flex flex-col items-center justify-center relative hover:bg-green-50 transition h-32">
                    <input type="file" id="img2pdfInput" multiple accept="image/png, image/jpeg, image/jpg" class="absolute inset-0 opacity-0 cursor-pointer z-10" onchange="handleFileSelect('img2pdf')">
                    <i data-lucide="image-plus" class="w-8 h-8 text-green-500 mb-2"></i>
                    <p class="text-sm font-medium text-gray-600">Select Photos</p>
                </div>
                <div id="img2pdfList" class="flex flex-col gap-2 overflow-y-auto max-h-48 hidden"></div>
                <div class="flex-1"></div>
                <button id="btn-img2pdf-action" onclick="processImgToPdf()" disabled class="w-full bg-green-500 text-white font-semibold py-4 rounded-xl shadow-lg shadow-green-200 btn-press disabled:opacity-50">Create PDF</button>
            </div>
        </div>

        <!-- 6. PDF TO IMG -->
        <div id="tool-pdf2img" class="screen flex-col h-full hidden bg-white">
            <div class="p-6 flex-1 flex flex-col gap-6">
                <div class="text-center">
                    <h3 class="text-xl font-bold text-gray-800">PDF to Images</h3>
                    <p class="text-xs text-gray-500">Convert to HD Images (ZIP).</p>
                </div>
                <div class="bg-orange-50/50 border-2 border-dashed border-orange-200 rounded-xl p-6 flex flex-col items-center justify-center relative h-32">
                    <input type="file" id="pdf2imgInput" accept=".pdf" class="absolute inset-0 opacity-0 cursor-pointer z-10" onchange="handleFileSelect('pdf2img')">
                    <p id="pdf2imgFileName" class="text-sm font-medium text-orange-600 truncate max-w-[200px]">Select PDF</p>
                </div>
                <div class="flex-1"></div>
                <button id="btn-pdf2img-action" onclick="processPdfToImg()" disabled class="w-full bg-orange-500 text-white font-semibold py-4 rounded-xl shadow-lg shadow-orange-200 btn-press disabled:opacity-50">Convert & Download</button>
            </div>
        </div>

        <!-- 7. COLLAGE -->
        <div id="tool-grid" class="screen flex-col h-full hidden bg-white">
            <div class="p-6 flex-1 flex flex-col gap-6">
                <div class="text-center">
                    <h3 class="text-xl font-bold text-gray-800">Grid Collage</h3>
                    <p class="text-xs text-gray-500">Fit 2 or 4 pages on one sheet.</p>
                </div>
                <div class="bg-indigo-50/50 border-2 border-dashed border-indigo-200 rounded-xl p-6 flex flex-col items-center justify-center relative h-32">
                    <input type="file" id="gridInput" accept=".pdf" class="absolute inset-0 opacity-0 cursor-pointer z-10" onchange="handleFileSelect('grid')">
                    <p id="gridFileName" class="text-sm font-medium text-indigo-600 truncate max-w-[200px]">Select PDF</p>
                </div>
                <div id="gridOptions" class="hidden flex-col gap-3">
                    <div class="grid grid-cols-2 gap-3">
                        <button onclick="selectGrid(2, this)" class="grid-opt p-3 border border-indigo-200 rounded-lg text-sm font-medium bg-indigo-50 text-indigo-700" data-val="2">2 Pages</button>
                        <button onclick="selectGrid(4, this)" class="grid-opt p-3 border border-gray-200 rounded-lg text-sm font-medium text-gray-600" data-val="4">4 Pages</button>
                    </div>
                </div>
                <div class="flex-1"></div>
                <button id="btn-grid-action" onclick="processGrid()" disabled class="w-full bg-indigo-500 text-white font-semibold py-4 rounded-xl shadow-lg shadow-indigo-200 btn-press disabled:opacity-50">Create Collage</button>
            </div>
        </div>

        <!-- 8. PDF VIEWER TOOL -->
        <div id="tool-viewer" class="screen flex-col h-full hidden bg-white">
            <div class="flex-none p-4 border-b border-gray-100 flex items-center justify-between">
                <div class="flex items-center gap-2">
                    <button onclick="changePage(-1)" class="p-2 rounded-lg hover:bg-gray-100 text-gray-600"><i data-lucide="chevron-left" class="w-5 h-5"></i></button>
                    <span id="pageInfo" class="text-sm font-medium text-gray-600">Page 1 / 1</span>
                    <button onclick="changePage(1)" class="p-2 rounded-lg hover:bg-gray-100 text-gray-600"><i data-lucide="chevron-right" class="w-5 h-5"></i></button>
                </div>
                <div class="flex items-center gap-2">
                    <button onclick="toggleFlipMode()" id="btnFlipMode" class="p-2 rounded-lg hover:bg-gray-100 text-gray-600 flex items-center gap-1 text-xs">
                        <i data-lucide="book-open" class="w-4 h-4"></i> Flip
                    </button>
                    <div class="w-px h-6 bg-gray-200 mx-1"></div>
                    <button onclick="changeZoom(-0.2)" class="p-2 rounded-lg hover:bg-gray-100 text-gray-600"><i data-lucide="zoom-out" class="w-5 h-5"></i></button>
                    <button onclick="changeZoom(0.2)" class="p-2 rounded-lg hover:bg-gray-100 text-gray-600"><i data-lucide="zoom-in" class="w-5 h-5"></i></button>
                </div>
            </div>

            <div id="viewerContainer" class="flex-1 overflow-auto bg-gray-100 flex justify-center p-4 relative">
                <div id="viewerPlaceholder" class="absolute inset-0 flex flex-col items-center justify-center pointer-events-none z-10">
                    <div class="bg-white p-6 rounded-xl shadow-sm text-center pointer-events-auto">
                        <p class="text-gray-500 mb-4">Select a PDF to view</p>
                        <button onclick="document.getElementById('viewerInput').click()" class="bg-teal-500 text-white px-4 py-2 rounded-lg shadow-md shadow-teal-200">Open PDF</button>
                    </div>
                </div>
                <!-- Normal Canvas -->
                <canvas id="pdfViewerCanvas" class="shadow-lg hidden transition-transform origin-top"></canvas>
                <!-- Flip Book Container -->
                <div id="flipBookContainer" class="hidden shadow-2xl"></div>
            </div>
            <input type="file" id="viewerInput" accept=".pdf" class="hidden" onchange="handleFileSelect('viewer')">
        </div>

        <!-- 9. ORGANIZE TOOL -->
        <div id="tool-organize" class="screen flex-col h-full hidden bg-white">
            <div class="p-6 flex-1 flex flex-col gap-6">
                <div class="text-center">
                    <h3 class="text-xl font-bold text-gray-800">Organize PDF</h3>
                    <p class="text-xs text-gray-500">Sort, Rotate, Delete Pages</p>
                </div>

                <div id="organizeUpload" class="bg-purple-50/50 border-2 border-dashed border-purple-200 rounded-xl p-6 flex flex-col items-center justify-center relative h-32">
                    <input type="file" id="organizeInput" accept=".pdf" class="absolute inset-0 opacity-0 cursor-pointer z-10" onchange="handleFileSelect('organize')">
                    <i data-lucide="layout-list" class="w-8 h-8 text-purple-400 mb-2"></i>
                    <p class="text-sm font-medium text-purple-600">Select PDF</p>
                </div>

                <div id="organizeContainer" class="hidden flex-1 overflow-y-auto bg-gray-50 rounded-xl p-4 grid grid-cols-2 gap-4">
                    <!-- Pages injected here -->
                </div>

                <button id="btn-organize-action" onclick="processOrganize()" disabled class="w-full bg-purple-600 text-white font-semibold py-4 rounded-xl shadow-lg shadow-purple-200 btn-press disabled:opacity-50">Save PDF</button>
            </div>
        </div>

        <!-- 10. WATERMARK TOOL -->
        <div id="tool-watermark" class="screen flex-col h-full hidden bg-white">
            <div class="p-6 flex-1 flex flex-col gap-6">
                <div class="text-center">
                    <h3 class="text-xl font-bold text-gray-800">Watermark PDF</h3>
                    <p class="text-xs text-gray-500">Add text stamp</p>
                </div>

                <div class="bg-cyan-50/50 border-2 border-dashed border-cyan-200 rounded-xl p-6 flex flex-col items-center justify-center relative h-32">
                    <input type="file" id="watermarkInput" accept=".pdf" class="absolute inset-0 opacity-0 cursor-pointer z-10" onchange="handleFileSelect('watermark')">
                    <p id="watermarkFileName" class="text-sm font-medium text-cyan-600 truncate max-w-[200px]">Select PDF</p>
                </div>

                <div id="watermarkOptions" class="hidden flex-col gap-3">
                    <input type="text" id="watermarkText" placeholder="Watermark Text" class="w-full bg-gray-50 border border-gray-200 rounded-lg p-3 text-sm focus:outline-none focus:ring-2 focus:ring-cyan-500">
                    <div class="flex gap-2">
                        <input type="color" id="watermarkColor" value="#ff0000" class="h-12 w-12 p-1 bg-white border rounded-lg cursor-pointer">
                        <input type="number" id="watermarkSize" value="50" placeholder="Size" class="flex-1 bg-gray-50 border border-gray-200 rounded-lg p-3 text-sm focus:outline-none focus:ring-2 focus:ring-cyan-500">
                    </div>
                </div>

                <div class="flex-1"></div>
                <button id="btn-watermark-action" onclick="processWatermark()" disabled class="w-full bg-cyan-600 text-white font-semibold py-4 rounded-xl shadow-lg shadow-cyan-200 btn-press disabled:opacity-50">Apply Watermark</button>
            </div>
        </div>

        <!-- 11. PAGE NUMBERS TOOL -->
        <div id="tool-pagenumber" class="screen flex-col h-full hidden bg-white">
            <div class="p-6 flex-1 flex flex-col gap-6">
                <div class="text-center">
                    <h3 class="text-xl font-bold text-gray-800">Page Numbers</h3>
                    <p class="text-xs text-gray-500">Add pagination</p>
                </div>

                <div class="bg-pink-50/50 border-2 border-dashed border-pink-200 rounded-xl p-6 flex flex-col items-center justify-center relative h-32">
                    <input type="file" id="pagenumberInput" accept=".pdf" class="absolute inset-0 opacity-0 cursor-pointer z-10" onchange="handleFileSelect('pagenumber')">
                    <p id="pagenumberFileName" class="text-sm font-medium text-pink-600 truncate max-w-[200px]">Select PDF</p>
                </div>

                <div id="pagenumberOptions" class="hidden flex-col gap-3">
                    <select id="pagenumberPos" class="w-full bg-gray-50 border border-gray-200 rounded-lg p-3 text-sm focus:outline-none focus:ring-2 focus:ring-pink-500">
                        <option value="bottom-center">Bottom Center</option>
                        <option value="bottom-right">Bottom Right</option>
                        <option value="bottom-left">Bottom Left</option>
                        <option value="top-center">Top Center</option>
                        <option value="top-right">Top Right</option>
                        <option value="top-left">Top Left</option>
                    </select>
                </div>

                <div class="flex-1"></div>
                <button id="btn-pagenumber-action" onclick="processPageNumber()" disabled class="w-full bg-pink-600 text-white font-semibold py-4 rounded-xl shadow-lg shadow-pink-200 btn-press disabled:opacity-50">Add Numbers</button>
            </div>
        </div>

        <!-- 12. DOC SCANNER TOOL -->
        <div id="tool-scanner" class="screen flex-col h-full hidden bg-black">
            <div class="flex-1 relative flex flex-col overflow-hidden">
                <video id="scannerVideo" autoplay playsinline class="w-full h-full object-cover"></video>
                <div id="scannerOverlay" class="absolute inset-0 pointer-events-none border-[20px] border-black/50 hidden"></div>

                <!-- Controls -->
                <div class="absolute bottom-0 left-0 right-0 p-8 flex items-center justify-between bg-gradient-to-t from-black/80 to-transparent">
                    <button onclick="showHome()" class="p-4 rounded-full bg-white/10 backdrop-blur text-white"><i data-lucide="x" class="w-6 h-6"></i></button>
                    <button onclick="captureScan()" class="w-16 h-16 rounded-full border-4 border-white bg-white/20 flex items-center justify-center ring-4 ring-black/20"></button>
                    <button onclick="finishScan()" id="btn-finish-scan" class="p-4 rounded-full bg-blue-500 text-white shadow-lg relative">
                        <i data-lucide="check" class="w-6 h-6"></i>
                        <span id="scanCount" class="absolute -top-1 -right-1 w-5 h-5 bg-red-500 rounded-full text-[10px] flex items-center justify-center font-bold hidden">0</span>
                    </button>
                </div>

                <div id="scanFlash" class="absolute inset-0 bg-white opacity-0 pointer-events-none transition-opacity duration-100"></div>
            </div>
        </div>

        <!-- 13. SIGN PDF TOOL -->
        <div id="tool-sign" class="screen flex-col h-full hidden bg-white">
            <div class="p-6 flex-1 flex flex-col gap-6">
                <div class="text-center">
                    <h3 class="text-xl font-bold text-gray-800">Sign PDF</h3>
                    <p class="text-xs text-gray-500">Draw signature & place.</p>
                </div>
                <div class="bg-blue-50/50 border-2 border-dashed border-blue-200 rounded-xl p-6 flex flex-col items-center justify-center relative h-32">
                    <input type="file" id="signInput" accept=".pdf" class="absolute inset-0 opacity-0 cursor-pointer z-10" onchange="handleFileSelect('sign')">
                    <p id="signFileName" class="text-sm font-medium text-blue-600 truncate max-w-[200px]">Select PDF</p>
                </div>
                <div id="signPad" class="hidden flex-col gap-2 flex-1">
                    <p class="text-xs font-bold text-gray-400 uppercase tracking-wide">Draw Signature</p>
                    <canvas id="signatureCanvas" class="w-full h-40 bg-gray-50 border border-gray-200 rounded-xl touch-none"></canvas>
                    <button onclick="clearSignature()" class="text-xs text-red-500 font-medium self-end">Clear</button>
                </div>
                <div class="flex-1"></div>
                <button id="btn-sign-action" onclick="processSign()" disabled class="w-full bg-blue-600 text-white font-semibold py-4 rounded-xl shadow-lg shadow-blue-200 btn-press disabled:opacity-50">Sign & Save</button>
            </div>
        </div>

        <!-- 14. TEXT TO PDF TOOL -->
        <div id="tool-text2pdf" class="screen flex-col h-full hidden bg-white">
            <div class="p-6 flex-1 flex flex-col gap-6">
                <div class="text-center">
                    <h3 class="text-xl font-bold text-gray-800">Text to PDF</h3>
                    <p class="text-xs text-gray-500">Create PDF from text.</p>
                </div>
                <textarea id="text2pdfInput" class="w-full flex-1 bg-gray-50 border border-gray-200 rounded-xl p-4 text-sm focus:outline-none focus:ring-2 focus:ring-emerald-500 resize-none" placeholder="Type or paste text here..."></textarea>
                <div class="flex gap-3">
                    <select id="text2pdfFont" class="w-1/2 bg-gray-50 border border-gray-200 rounded-lg p-3 text-sm">
                        <option value="Helvetica">Helvetica</option>
                        <option value="Times-Roman">Times New Roman</option>
                        <option value="Courier">Courier</option>
                    </select>
                    <input type="number" id="text2pdfSize" value="12" class="w-1/2 bg-gray-50 border border-gray-200 rounded-lg p-3 text-sm">
                </div>
                <button id="btn-text2pdf-action" onclick="processTextToPdf()" class="w-full bg-emerald-600 text-white font-semibold py-4 rounded-xl shadow-lg shadow-emerald-200 btn-press">Generate PDF</button>
            </div>
        </div>

        <!-- 15. COMPRESS TOOL -->
        <div id="tool-compress" class="screen flex-col h-full hidden bg-white">
             <div class="p-6 flex-1 flex flex-col gap-6">
                <div class="text-center">
                    <h3 class="text-xl font-bold text-gray-800">Compress PDF</h3>
                    <p class="text-xs text-gray-500">Reduce file size.</p>
                </div>
                <div class="bg-rose-50/50 border-2 border-dashed border-rose-200 rounded-xl p-6 flex flex-col items-center justify-center relative h-32">
                    <input type="file" id="compressInput" accept=".pdf" class="absolute inset-0 opacity-0 cursor-pointer z-10" onchange="handleFileSelect('compress')">
                    <p id="compressFileName" class="text-sm font-medium text-rose-600 truncate max-w-[200px]">Select PDF</p>
                </div>
                <div id="compressOptions" class="hidden flex-col gap-3">
                    <label class="text-xs font-bold text-gray-400 uppercase tracking-wide">Compression Level</label>
                    <div class="flex justify-between text-xs text-gray-400 px-1">
                        <span>Low</span>
                        <span>Med</span>
                        <span>High</span>
                    </div>
                    <input type="range" id="compressLevel" min="0.1" max="0.9" step="0.1" value="0.5" class="w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer">
                </div>
                <div class="flex-1"></div>
                <button id="btn-compress-action" onclick="processCompress()" disabled class="w-full bg-rose-500 text-white font-semibold py-4 rounded-xl shadow-lg shadow-rose-200 btn-press disabled:opacity-50">Compress PDF</button>
            </div>
        </div>

        <!-- 16. TINT TOOL -->
        <div id="tool-tint" class="screen flex-col h-full hidden bg-white">
            <div class="p-6 flex-1 flex flex-col gap-6">
                <div class="text-center">
                    <h3 class="text-xl font-bold text-gray-800">Page Color</h3>
                    <p class="text-xs text-gray-500">Change background color.</p>
                </div>
                <div class="bg-amber-50/50 border-2 border-dashed border-amber-200 rounded-xl p-6 flex flex-col items-center justify-center relative h-32">
                    <input type="file" id="tintInput" accept=".pdf" class="absolute inset-0 opacity-0 cursor-pointer z-10" onchange="handleFileSelect('tint')">
                    <p id="tintFileName" class="text-sm font-medium text-amber-600 truncate max-w-[200px]">Select PDF</p>
                </div>
                <div id="tintOptions" class="hidden flex-col gap-4">
                    <div class="flex gap-2 justify-center">
                        <button onclick="setTintColor('#fefce8')" class="w-8 h-8 rounded-full bg-yellow-50 border border-gray-200"></button>
                        <button onclick="setTintColor('#f0f9ff')" class="w-8 h-8 rounded-full bg-sky-50 border border-gray-200"></button>
                        <button onclick="setTintColor('#f0fdf4')" class="w-8 h-8 rounded-full bg-green-50 border border-gray-200"></button>
                        <button onclick="setTintColor('#18181b')" class="w-8 h-8 rounded-full bg-zinc-900 border border-gray-200"></button>
                    </div>
                    <input type="color" id="tintColor" value="#fefce8" class="w-full h-10 p-1 rounded-lg border border-gray-200">
                </div>
                <div class="flex-1"></div>
                <button id="btn-tint-action" onclick="processTint()" disabled class="w-full bg-amber-500 text-white font-semibold py-4 rounded-xl shadow-lg shadow-amber-200 btn-press disabled:opacity-50">Apply Color</button>
            </div>
        </div>

    </main>

    <!-- Overlay Loader -->
    <div id="loadingOverlay" class="fixed inset-0 bg-white/90 z-50 hidden items-center justify-center backdrop-blur-sm">
        <div class="flex flex-col items-center gap-6">
            <span class="loader"></span>
            <div class="text-center">
                <h4 id="loaderTitle" class="font-bold text-xl text-gray-800">Processing...</h4>
                <p id="loaderText" class="text-sm text-gray-500 mt-1">Please wait a moment</p>
            </div>
        </div>
    </div>

    <!-- Toast Notification -->
    <div id="toast" class="fixed bottom-8 left-1/2 transform -translate-x-1/2 bg-gray-900 text-white px-6 py-3.5 rounded-2xl shadow-xl text-sm font-medium transition-all duration-300 opacity-0 translate-y-10 z-50 flex items-center gap-3 whitespace-nowrap">
        <span id="toastIcon">‚ú®</span>
        <span id="toastMsg">Action Successful</span>
    </div>

    <!-- Hidden Canvas for Notebook Generation -->
    <canvas id="notebookCanvas" width="800" height="1100"></canvas>

    <script type="module" src="js/main.js"></script>
    <script>
        // Init worker
        pdfjsLib.GlobalWorkerOptions.workerSrc = 'https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.worker.min.js';
    </script>
</body>
</html>
